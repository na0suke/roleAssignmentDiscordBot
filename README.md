# 🎮 LoLロール決めBot

League of Legends（LoL）のロール決めを自動化するDiscord Botです。複数の機能でチームのロール分配を効率的に行えます。

## ✨ 機能一覧

### 1. 🎯 `/role` - 通常のロール決め
- **参加方法**: 数字リアクション（1️⃣〜5️⃣）で参加表明
- **抽選開始**: 🎲 をクリックしてロール分配
- **除外オプション**: 特定ロールを事前に除外可能
- **参加者制限**: なし（誰でも参加可能）

### 2. 🔒 `/secret_role` - 秘密のロール決め
- **参加条件**: VC（ボイスチャンネル）参加者限定
- **秘密性**: 一時的な専用チャンネルを作成
- **即座決定**: 数字を選択すると即座にロール確定
- **自動削除**: 完了後30秒でチャンネル自動削除

### 3. 🚫 `/exclude_role` - 除外設定ロール決め **【NEW!】**
- **参加条件**: VC参加者限定
- **除外機能**: やりたくないロールを事前に除外
- **柔軟設定**: 複数ロール除外可能、除外なしもOK
- **ランダム選択**: 5つのロールから参加者数分をランダム選択

## 🎮 ロール一覧

| ロール | 絵文字 | 説明 |
|--------|--------|------|
| **TOP** | ⚔️ | トップレーナー |
| **JG** | 🌲 | ジャングラー |
| **MID** | ⚡ | ミッドレーナー |
| **ADC** | 🏹 | ADキャリー |
| **SUP** | 🛡️ | サポーター |

## 📋 使用方法

### `/role` コマンド

```
/role
/role excluded_roles:top mid
```

1. コマンドを実行
2. 参加したい人が数字リアクション（1️⃣〜5️⃣）
3. 🎲 をクリックして抽選開始
4. ロール結果を表示

### `/secret_role` コマンド

```
/secret_role
/secret_role excluded_roles:jg sup
```

1. **VCに参加**してからコマンドを実行
2. 専用チャンネルが自動作成される
3. 数字を選択すると即座にロール確定
4. 全員決定後、チャンネル自動削除

### `/exclude_role` コマンド **【NEW!】**

```
/exclude_role
```

#### 📋 詳細手順

1. **VCに参加**（2人以上必要）
2. `/exclude_role` コマンドを実行
3. **除外ロール選択**（複数選択可能）:
   - **T** → TOP除外
   - **J** → JG除外  
   - **M** → MID除外
   - **A** → ADC除外
   - **S** → SUP除外
4. **▶️** をクリックしてロール分け実行
5. 除外設定を考慮したロール結果を表示

#### 💡 使用例

**シナリオ**: 4人でプレイ
- **太郎**: T と J にリアクション（TOP・JG除外）
- **花子**: リアクションなし（全ロールOK）
- **次郎**: S にリアクション（SUP除外）
- **四郎**: M にリアクション（MID除外）

**結果例**:
```
🚫 除外設定一覧
• 太郎: 除外 トップ, ジャングル
• 花子: 除外なし（全ロールOK）
• 次郎: 除外 サポート
• 四郎: 除外 ミッド

🎯 ロール割り当て結果
太郎 → ⚡ ミッド
花子 → ⚔️ トップ
次郎 → 🏹 ADC
四郎 → 🛡️ サポート
```

## 🔧 セットアップ

### 必要な環境
- Python 3.8以上
- discord.py

### インストール

1. **リポジトリをクローン**
```bash
git clone <repository-url>
cd lol-role-bot
```

2. **依存関係をインストール**
```bash
pip install discord.py
```

3. **環境変数を設定**
```bash
export DISCORD_TOKEN="your_bot_token_here"
```

または `.env` ファイルを作成:
```env
DISCORD_TOKEN=your_bot_token_here
```

4. **Botを起動**
```bash
python bot.py
```

### Discord Bot設定

1. [Discord Developer Portal](https://discord.com/developers/applications) でアプリケーション作成
2. Bot作成してトークンを取得
3. **必要な権限**:
   - `Send Messages`
   - `Add Reactions`
   - `Manage Channels`
   - `Read Message History`
   - `Use Slash Commands`
4. サーバーにBotを招待

## 🎯 機能比較

| 機能 | `/role` | `/secret_role` | `/exclude_role` |
|------|---------|----------------|-----------------|
| **参加条件** | なし | VC参加者のみ | VC参加者のみ |
| **除外設定** | コマンド実行時 | コマンド実行時 | リアクションで個別設定 |
| **秘密性** | 公開 | 秘密（専用チャンネル） | 公開 |
| **参加方法** | 数字リアクション | 数字選択 | 自動（VC参加者） |
| **結果表示** | 即座 | 即座 | 一括表示 |
| **ロール選択** | 固定順序 | ランダム | ランダム |

## ⚠️ 注意事項

### 共通
- **タイムアウト**: 5分間操作がないと自動終了
- **Bot権限**: 適切な権限が必要
- **同時実行**: 複数のロール決めを同時実行可能

### `/secret_role` 特有
- **チャンネル作成権限**が必要
- **VC参加者数**が利用可能ロール数以上必要
- **管理者でもVC非参加なら除外**される

### `/exclude_role` 特有
- **除外しすぎると割り当て不可能**になる場合がある
- **ランダムロール選択**により毎回異なる組み合わせ
- **制約充足アルゴリズム**で最適解を探索（最大100回試行）

## 🔄 アップデート履歴

### v3.0.0 - 2025年
- **NEW**: `/exclude_role` コマンド追加
- **IMPROVED**: ランダムロール選択機能
- **ENHANCED**: 制約充足アルゴリズム実装

### v2.0.0 - 2025年
- **NEW**: `/secret_role` コマンド追加
- **IMPROVED**: VC参加者限定機能

### v1.0.0 - 2025年
- **INITIAL**: `/role` コマンド実装
- **BASIC**: 基本的なロール決め機能

## 🤝 サポート

### よくある質問

**Q: VCに参加していないのに除外される**
A: `/exclude_role` と `/secret_role` はVC参加者限定です。VCに参加してからコマンドを実行してください。

**Q: 除外設定でロール割り当てができない**
A: 除外するロールが多すぎると割り当て不可能になります。除外設定を減らしてください。

**Q: Botが反応しない**
A: Bot権限とインターネット接続を確認してください。エラーログも確認してください。

### 問題報告
- GitHubのIssueで報告
- エラーログを含めて詳細を記載

## 📄 ライセンス

MIT License - 詳細は `LICENSE` ファイルを参照

## 🎉 貢献

プルリクエストやバグ報告を歓迎します！

---

**楽しいLoLライフを！** 🎮✨